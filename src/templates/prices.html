{% extends 'base.html' %}
{% block content %}
   <br>

   <div id="placeholder_prices" style="width:100%;height:500px;"></div>
   <!--[if IE]>
    <script type="text/javascript" src="path/to/flashcanvas.js"></script>
    <![endif]-->
    <script type="text/javascript" src="../static/js/flotr2.min.js"></script>
    <script type="text/javascript">
      
      function padTo2Digits(num) {
        return num.toString().padStart(2, '0');
      }
      function formatDate(date) {
        return (
          [
            padTo2Digits(date.getHours()),
            padTo2Digits(date.getMinutes()),
            padTo2Digits(date.getSeconds()),
          ].join(':')
        );
        return (
          [
            date.getFullYear(),
            padTo2Digits(date.getMonth() + 1),
            padTo2Digits(date.getDate()),
          ].join('-') +
          ' ' +
          [
            padTo2Digits(date.getHours()),
            padTo2Digits(date.getMinutes()),
            padTo2Digits(date.getSeconds()),
          ].join(':')
        );
      }

      (function mouse_drag() {
        
        var container_prices = document.getElementById('placeholder_prices')
        var prices = {{ prices|safe }};
        
        /* multiply by 1000 to convert seconds into milliseconds */
        for (i=0; i< prices.length; i++) {
          prices[i][0] = 1000 * prices[i][0];
        }
        
        options_prices = {
          xaxis : {
            labelsAngle : 45, 
            title : "Tijd",
            mode : 'Time',
            timeMode : 'local',
            noTicks: 23,
            tickFormatter: function (x) { return formatDate(new Date(parseInt(x)));   }          
          },
          yaxis : {
            minorTicks : [1,3],
            title : "Euro"
          },
          legend: {
            position: "sw",
          },
          selection : {
            mode : 'x'
          },
          title : "KWh prijzen uitgezet tegen de tijd",
          HtmlText : false
        };

        // Draw graph with default options_energy, overwriting with passed options
        
        function drawGraph_prices (opts) {

          // Clone the options, so the 'options_energy' variable always keeps intact.
          var o = Flotr._.extend(Flotr._.clone(options_prices), opts || {});

          // Return a new graph.
          return Flotr.draw(
            container_prices,
            [ {data : prices            , label : 'Prijzen'         , color: "#BB6633"} ],
            options_prices
          );
        }
    
        graph_prices = drawGraph_prices();      

      Flotr.EventAdapter.observe(container_prices, 'flotr:select', function(area){
            // Draw selected area
            graph_energy = drawGraph_energy({ xaxis : { min : area.x1, max : area.x2, mode : 'time', labelsAngle : 45 },
                                yaxis : { min : area.y1, max : area.y2 }
                });
        });
        
        // When graph is clicked, draw the graph with default area.
      Flotr.EventAdapter.observe(container_prices, 'flotr:click', function () { graph_prices = drawGraph_prices(); });

      })();

      
    </script>

<br>

{% endblock %}

